<?php
session_start();
require_once 'config.php';

// Ki·ªÉm tra quy·ªÅn admin
if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
    header("Location: admin_login.html");
    exit;
}
?>
<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Qu·∫£n tr·ªã h·ªá th·ªëng CGV</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
      .admin-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      .welcome-card {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        margin-bottom: 30px;
        text-align: center;
      }
      .admin-card {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        margin-bottom: 20px;
        transition: transform 0.3s ease;
      }
      .admin-card:hover {
        transform: translateY(-5px);
      }
      .feature-btn {
        width: 100%;
        padding: 15px;
        margin: 10px 0;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        text-decoration: none;
        display: inline-block;
        text-align: center;
        transition: all 0.3s ease;
      }
      .btn-movies {
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        color: white;
      }
      .btn-showtimes {
        background: linear-gradient(45deg, #4834d4, #686de0);
        color: white;
      }
      .btn-tickets {
        background: linear-gradient(45deg, #00d2d3, #01a3a4);
        color: white;
      }
      .btn-users {
        background: linear-gradient(45deg, #feca57, #ff9ff3);
        color: white;
      }
      .btn-stats {
        background: linear-gradient(45deg, #48dbfb, #0abde3);
        color: white;
      }
      .btn-logout {
        background: linear-gradient(45deg, #ff3838, #ff4757);
        color: white;
      }
      .feature-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        color: white;
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <div class="admin-container">
      <div class="welcome-card">
        <h1><i class="bi bi-shield-check"></i> Ch√†o m·ª´ng ƒë·∫øn Admin CGV</h1>
        <p class="lead">H·ªá th·ªëng qu·∫£n tr·ªã r·∫°p chi·∫øu phim</p>
        <hr>
        <p>Xin ch√†o <strong><?php echo $_SESSION['fullname']; ?></strong>! Qu·∫£n l√Ω to√†n b·ªô ho·∫°t ƒë·ªông c·ªßa h·ªá th·ªëng CGV</p>
      </div>

      <div class="row">
        <!-- Qu·∫£n l√Ω Phim -->
        <div class="col-md-6 col-lg-4">
          <div class="admin-card">
            <h4><i class="bi bi-film"></i> Qu·∫£n l√Ω Phim</h4>
            <p>Th√™m, s·ª≠a, x√≥a th√¥ng tin phim</p>
            <a href="admin_movies.php" class="feature-btn btn-movies">
              <i class="bi bi-plus-circle"></i> Qu·∫£n l√Ω Phim
            </a>
          </div>
        </div>

        <!-- Qu·∫£n l√Ω Su·∫•t Chi·∫øu -->
        <div class="col-md-6 col-lg-4">
          <div class="admin-card">
            <h4><i class="bi bi-calendar-event"></i> Qu·∫£n l√Ω Su·∫•t Chi·∫øu</h4>
            <p>T·∫°o l·ªãch chi·∫øu cho c√°c phim</p>
            <a href="admin_showtimes.php" class="feature-btn btn-showtimes">
              <i class="bi bi-clock"></i> Qu·∫£n l√Ω Su·∫•t Chi·∫øu
            </a>
          </div>
        </div>

        <!-- Qu·∫£n l√Ω V√© -->
        <div class="col-md-6 col-lg-4">
          <div class="admin-card">
            <h4><i class="bi bi-ticket-perforated"></i> Qu·∫£n l√Ω V√©</h4>
            <p>Xem danh s√°ch v√© ƒë√£ ƒë·∫∑t</p>
            <a href="admin_tickets.php" class="feature-btn btn-tickets">
              <i class="bi bi-list-check"></i> Xem V√© ƒê√£ ƒê·∫∑t
            </a>
          </div>
        </div>

        <!-- Qu·∫£n l√Ω Kh√°ch H√†ng -->
        <div class="col-md-6 col-lg-4">
          <div class="admin-card">
            <h4><i class="bi bi-people"></i> Qu·∫£n l√Ω Kh√°ch H√†ng</h4>
            <p>Xem th√¥ng tin kh√°ch h√†ng</p>
            <a href="admin_users.php" class="feature-btn btn-users">
              <i class="bi bi-person-lines-fill"></i> Danh S√°ch Kh√°ch H√†ng
            </a>
          </div>
        </div>

        <!-- Th·ªëng K√™ -->
        <div class="col-md-6 col-lg-4">
          <div class="admin-card">
            <h4><i class="bi bi-graph-up"></i> Th·ªëng K√™</h4>
            <p>B√°o c√°o doanh thu v√† s·ªë li·ªáu</p>
            <a href="admin_stats.php" class="feature-btn btn-stats">
              <i class="bi bi-bar-chart"></i> Xem Th·ªëng K√™
            </a>
          </div>
        </div>

        <!-- ƒêƒÉng Xu·∫•t -->
        <div class="col-md-6 col-lg-4">
          <div class="admin-card">
            <h4><i class="bi bi-box-arrow-right"></i> ƒêƒÉng Xu·∫•t</h4>
            <p>Tho√°t kh·ªèi h·ªá th·ªëng</p>
            <a href="logout.php" class="feature-btn btn-logout">
              <i class="bi bi-power"></i> ƒêƒÉng Xu·∫•t
            </a>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<?php
session_start();
require_once 'config.php';

if ($_POST) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    // Ki·ªÉm tra th√¥ng tin ƒëƒÉng nh·∫≠p admin
    $stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND role = 'admin'");
    $stmt->execute([$username]);
    $admin = $stmt->fetch(PDO::FETCH_ASSOC);

    if ($admin && password_verify($password, $admin['password'])) {
        // ƒêƒÉng nh·∫≠p th√†nh c√¥ng
        $_SESSION['user_id'] = $admin['id'];
        $_SESSION['username'] = $admin['username'];
        $_SESSION['fullname'] = $admin['fullname'];
        $_SESSION['role'] = $admin['role'];

        header("Location: admin.php");
        exit;
    } else {
        // ƒêƒÉng nh·∫≠p th·∫•t b·∫°i
        header("Location: admin_login.html?error=1");
        exit;
    }
}
?>
<?php
session_start();
require_once 'config.php';

// Ki·ªÉm tra quy·ªÅn admin
if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
    header("Location: login.html");
    exit;
}

// Th√™m phim m·ªõi
if ($_POST && isset($_POST['action']) && $_POST['action'] == 'add_movie') {
    $title = $_POST['title'];
    $genre = $_POST['genre'];
    $duration = $_POST['duration'];
    $release_date = $_POST['release_date'];
    $image = $_POST['image_url'];
    $description = $_POST['description'];
    $category_id = $_POST['category_id'];

    $stmt = $pdo->prepare("INSERT INTO movies (title, genre, duration, release_date, image, description, category_id) VALUES (?, ?, ?, ?, ?, ?, ?)");

    if ($stmt->execute([$title, $genre, $duration, $release_date, $image, $description, $category_id])) {
        echo "<script>alert('Th√™m phim th√†nh c√¥ng!');</script>";
    }
}

// L·∫•y danh s√°ch phim
$stmt = $pdo->prepare("SELECT m.*, c.name as category_name FROM movies m LEFT JOIN categories c ON m.category_id = c.id ORDER BY m.id DESC");
$stmt->execute();
$movies = $stmt->fetchAll(PDO::FETCH_ASSOC);
?>

<!DOCTYPE html>
<html>

<head>
    <title>Qu·∫£n l√Ω phim - Admin CGV</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            padding: 20px;
        }

        .admin-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .table th {
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="admin-card">
            <h1><i class="bi bi-film"></i> Qu·∫£n l√Ω Phim CGV</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="admin.php">Trang ch·ªß Admin</a></li>
                    <li class="breadcrumb-item active">Qu·∫£n l√Ω Phim</li>
                </ol>
            </nav>
        </div>

        <div class="admin-card">
            <h3>Th√™m phim m·ªõi</h3>
            <form method="POST" class="mb-4">
                <input type="hidden" name="action" value="add_movie">
                <div class="row">
                    <div class="col-md-4">
                        <input type="text" name="title" class="form-control" placeholder="T√™n phim" required />
                    </div>
                    <div class="col-md-3">
                        <input type="text" name="genre" class="form-control" placeholder="Th·ªÉ lo·∫°i" />
                    </div>
                    <div class="col-md-3">
                        <input type="text" name="duration" class="form-control" placeholder="Th·ªùi l∆∞·ª£ng" />
                    </div>
                    <div class="col-md-2">
                        <input type="date" name="release_date" class="form-control" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <input type="text" name="image_url" class="form-control" placeholder="Link ·∫£nh poster" />
                    </div>
                    <div class="col-md-3">
                        <select name="category_id" class="form-control" required>
                            <option value="1">H√†nh ƒê·ªông</option>
                            <option value="2">T√¨nh C·∫£m</option>
                            <option value="3">Ho·∫°t H√¨nh</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-plus-circle"></i> Th√™m Phim
                        </button>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-12">
                        <textarea name="description" class="form-control" placeholder="M√¥ t·∫£ phim"></textarea>
                    </div>
                </div>
            </form>
        </div>

        <div class="admin-card">
            <h3>Danh s√°ch phim</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>T√™n phim</th>
                            <th>Th·ªÉ lo·∫°i</th>
                            <th>Th·ªùi l∆∞·ª£ng</th>
                            <th>Ng√†y ph√°t h√†nh</th>
                            <th>Danh m·ª•c</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($movies as $movie): ?>
                        <tr>
                            <td><?php echo $movie['id']; ?></td>
                            <td><?php echo $movie['title']; ?></td>
                            <td><?php echo $movie['genre']; ?></td>
                            <td><?php echo $movie['duration']; ?></td>
                            <td><?php echo $movie['release_date']; ?></td>
                            <td><?php echo $movie['category_name']; ?></td>
                        </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="admin-card text-center">
            <a href="admin.php" class="btn btn-secondary me-2">
                <i class="bi bi-house"></i> V·ªÅ trang ch·ªß Admin
            </a>
            <a href="admin_showtimes.php" class="btn btn-primary me-2">
                <i class="bi bi-calendar-event"></i> Qu·∫£n l√Ω su·∫•t chi·∫øu
            </a>
            <a href="logout.php" class="btn btn-danger">
                <i class="bi bi-power"></i> ƒêƒÉng xu·∫•t
            </a>
        </div>
    </div>
</body>

</html>
<?php
session_start();
require_once 'config.php';

// Ki·ªÉm tra quy·ªÅn admin
if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
    header("Location: login.html");
    exit;
}

// Th√™m su·∫•t chi·∫øu m·ªõi
if ($_POST && isset($_POST['action']) && $_POST['action'] == 'add_showtime') {
    $movie_id = $_POST['movie_id'];
    $cinema_id = $_POST['cinema_id'];
    $show_date = $_POST['show_date'];
    $show_time = $_POST['show_time'];

    $stmt = $pdo->prepare("INSERT INTO showtimes (movie_id, cinema_id, show_date, show_time, total_seats, available_seats) VALUES (?, ?, ?, ?, 60, 60)");

    if ($stmt->execute([$movie_id, $cinema_id, $show_date, $show_time])) {
        echo "<script>alert('Th√™m su·∫•t chi·∫øu th√†nh c√¥ng!');</script>";
    }
}

// L·∫•y danh s√°ch phim v√† r·∫°p
$stmt = $pdo->prepare("SELECT id, title FROM movies ORDER BY title");
$stmt->execute();
$movies = $stmt->fetchAll(PDO::FETCH_ASSOC);

$stmt = $pdo->prepare("SELECT id, name FROM cinemas ORDER BY name");
$stmt->execute();
$cinemas = $stmt->fetchAll(PDO::FETCH_ASSOC);

// L·∫•y danh s√°ch su·∫•t chi·∫øu
$stmt = $pdo->prepare("
    SELECT s.*, m.title as movie_title, c.name as cinema_name 
    FROM showtimes s 
    JOIN movies m ON s.movie_id = m.id 
    JOIN cinemas c ON s.cinema_id = c.id 
    WHERE s.show_date >= CURDATE()
    ORDER BY s.show_date, s.show_time
");
$stmt->execute();
$showtimes = $stmt->fetchAll(PDO::FETCH_ASSOC);
?>

<!DOCTYPE html>
<html>

<head>
    <title>Qu·∫£n l√Ω su·∫•t chi·∫øu - Admin CGV</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            padding: 20px;
        }

        .admin-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .table th {
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="admin-card">
            <h1><i class="bi bi-calendar-event"></i> Qu·∫£n l√Ω Su·∫•t Chi·∫øu CGV</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="admin.php">Trang ch·ªß Admin</a></li>
                    <li class="breadcrumb-item active">Qu·∫£n l√Ω Su·∫•t Chi·∫øu</li>
                </ol>
            </nav>
        </div>

        <div class="admin-card">
            <div class="row">
                <div class="col-md-6">
                    <h3>Th√™m su·∫•t chi·∫øu m·ªõi</h3>
                    <form method="POST" class="mb-4">
                        <input type="hidden" name="action" value="add_showtime">
                        <div class="mb-3">
                            <label>Phim:</label>
                            <select name="movie_id" class="form-control" required>
                                <option value="">Ch·ªçn phim</option>
                                <?php foreach ($movies as $movie): ?>
                                <option value="<?php echo $movie['id']; ?>"><?php echo $movie['title']; ?></option>
                                <?php endforeach; ?>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label>R·∫°p:</label>
                            <select name="cinema_id" class="form-control" required>
                                <option value="">Ch·ªçn r·∫°p</option>
                                <?php foreach ($cinemas as $cinema): ?>
                                <option value="<?php echo $cinema['id']; ?>"><?php echo $cinema['name']; ?></option>
                                <?php endforeach; ?>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label>Ng√†y chi·∫øu:</label>
                            <input type="date" name="show_date" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label>Gi·ªù chi·∫øu:</label>
                            <input type="time" name="show_time" class="form-control" required />
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-plus-circle"></i> Th√™m su·∫•t chi·∫øu
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div class="admin-card">
            <h3>Danh s√°ch su·∫•t chi·∫øu</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Phim</th>
                            <th>R·∫°p</th>
                            <th>Ng√†y</th>
                            <th>Gi·ªù</th>
                            <th>Gh·∫ø c√≤n l·∫°i</th>
                            <th>Tr·∫°ng th√°i</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($showtimes as $showtime): ?>
                        <tr>
                            <td><?php echo $showtime['movie_title']; ?></td>
                            <td><?php echo $showtime['cinema_name']; ?></td>
                            <td><?php echo date('d/m/Y', strtotime($showtime['show_date'])); ?></td>
                            <td><?php echo date('H:i', strtotime($showtime['show_time'])); ?></td>
                            <td><?php echo $showtime['available_seats']; ?>/<?php echo $showtime['total_seats']; ?></td>
                            <td>
                                <?php if ($showtime['available_seats'] > 0): ?>
                                <span class="badge bg-success">C√≤n v√©</span>
                                <?php else: ?>
                                <span class="badge bg-danger">H·∫øt v√©</span>
                                <?php endif; ?>
                            </td>
                        </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="admin-card text-center">
            <a href="admin.php" class="btn btn-secondary me-2">
                <i class="bi bi-house"></i> V·ªÅ trang ch·ªß Admin
            </a>
            <a href="admin_movies.php" class="btn btn-primary me-2">
                <i class="bi bi-film"></i> Qu·∫£n l√Ω phim
            </a>
            <a href="logout.php" class="btn btn-danger">
                <i class="bi bi-power"></i> ƒêƒÉng xu·∫•t
            </a>
        </div>
    </div>
</body>

</html>
<?php
session_start();
require_once 'config.php';

// Ki·ªÉm tra quy·ªÅn admin
if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
    header("Location: login.html");
    exit;
}

// Th·ªëng k√™ t·ªïng quan
$stats = [];

// Th·ªëng k√™ phim
$stmt = $pdo->prepare("
    SELECT m.title, COUNT(b.id) as bookings, SUM(b.quantity) as tickets_sold
    FROM movies m
    LEFT JOIN showtimes s ON m.id = s.movie_id
    LEFT JOIN bookings b ON s.id = b.showtime_id
    GROUP BY m.id
    ORDER BY tickets_sold DESC
    LIMIT 10
");
$stmt->execute();
$popular_movies = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Th·ªëng k√™ doanh thu theo th√°ng
$stmt = $pdo->prepare("
    SELECT DATE_FORMAT(booking_date, '%Y-%m') as month,
           COUNT(*) as total_bookings,
           SUM(quantity) as total_tickets,
           SUM(ticket_price * quantity) as revenue
    FROM bookings
    WHERE booking_date >= DATE_SUB(NOW(), INTERVAL 6 MONTH)
    GROUP BY month
    ORDER BY month DESC
");
$stmt->execute();
$monthly_stats = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Th·ªëng k√™ r·∫°p
$stmt = $pdo->prepare("
    SELECT c.name, COUNT(b.id) as bookings, SUM(b.quantity) as tickets_sold
    FROM cinemas c
    LEFT JOIN showtimes s ON c.id = s.cinema_id
    LEFT JOIN bookings b ON s.id = b.showtime_id
    GROUP BY c.id
    ORDER BY tickets_sold DESC
");
$stmt->execute();
$cinema_stats = $stmt->fetchAll(PDO::FETCH_ASSOC);

// T·ªïng quan h·ªá th·ªëng
$stmt = $pdo->prepare("SELECT COUNT(*) FROM movies");
$stmt->execute();
$total_movies = $stmt->fetchColumn();

$stmt = $pdo->prepare("SELECT COUNT(*) FROM users WHERE role = 'customer'");
$stmt->execute();
$total_customers = $stmt->fetchColumn();

$stmt = $pdo->prepare("SELECT COUNT(*) FROM bookings");
$stmt->execute();
$total_bookings = $stmt->fetchColumn();

$stmt = $pdo->prepare("SELECT SUM(ticket_price * quantity) FROM bookings");
$stmt->execute();
$total_revenue = $stmt->fetchColumn() ?: 0;
?>

<!DOCTYPE html>
<html>

<head>
    <title>Th·ªëng K√™ - Admin CGV</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            padding: 20px;
        }

        .admin-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .stats-card {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            color: white;
        }

        .stats-movies {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }

        .stats-customers {
            background: linear-gradient(45deg, #4834d4, #686de0);
        }

        .stats-bookings {
            background: linear-gradient(45deg, #00d2d3, #01a3a4);
        }

        .stats-revenue {
            background: linear-gradient(45deg, #feca57, #ff9ff3);
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="admin-card">
            <h1><i class="bi bi-graph-up"></i> Th·ªëng K√™ H·ªá Th·ªëng CGV</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="admin.php">Trang ch·ªß Admin</a></li>
                    <li class="breadcrumb-item active">Th·ªëng K√™</li>
                </ol>
            </nav>
        </div>

        <!-- Th·ªëng k√™ t·ªïng quan -->
        <div class="row">
            <div class="col-md-3">
                <div class="stats-card stats-movies">
                    <i class="bi bi-film" style="font-size: 2rem;"></i>
                    <h3><?php echo $total_movies; ?></h3>
                    <p>T·ªïng s·ªë phim</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card stats-customers">
                    <i class="bi bi-people" style="font-size: 2rem;"></i>
                    <h3><?php echo $total_customers; ?></h3>
                    <p>Kh√°ch h√†ng</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card stats-bookings">
                    <i class="bi bi-ticket-perforated" style="font-size: 2rem;"></i>
                    <h3><?php echo $total_bookings; ?></h3>
                    <p>V√© ƒë√£ ƒë·∫∑t</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card stats-revenue">
                    <i class="bi bi-currency-dollar" style="font-size: 2rem;"></i>
                    <h3><?php echo number_format($total_revenue/1000); ?>K</h3>
                    <p>Doanh thu (VNƒê)</p>
                </div>
            </div>
        </div>

        <!-- Top phim b√°n ch·∫°y -->
        <div class="admin-card">
            <h3><i class="bi bi-trophy"></i> Top Phim B√°n Ch·∫°y</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>H·∫°ng</th>
                            <th>T√™n Phim</th>
                            <th>S·ªë l∆∞·ª£t ƒë·∫∑t</th>
                            <th>V√© ƒë√£ b√°n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($popular_movies as $index => $movie): ?>
                        <tr>
                            <td>
                                <?php if ($index < 3): ?>
                                <span class="badge bg-warning">#{<?php echo $index + 1; ?>}</span>
                                <?php else: ?>
                                #{<?php echo $index + 1; ?>}
                                <?php endif; ?>
                            </td>
                            <td><?php echo $movie['title']; ?></td>
                            <td><?php echo $movie['bookings'] ?: 0; ?> l∆∞·ª£t</td>
                            <td><?php echo $movie['tickets_sold'] ?: 0; ?> v√©</td>
                        </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Th·ªëng k√™ doanh thu theo th√°ng -->
        <div class="admin-card">
            <h3><i class="bi bi-bar-chart"></i> Doanh Thu 6 Th√°ng G·∫ßn ƒê√¢y</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Th√°ng</th>
                            <th>S·ªë l∆∞·ª£t ƒë·∫∑t</th>
                            <th>V√© ƒë√£ b√°n</th>
                            <th>Doanh thu</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($monthly_stats as $month): ?>
                        <tr>
                            <td><?php echo date('m/Y', strtotime($month['month'] . '-01')); ?></td>
                            <td><?php echo $month['total_bookings']; ?> l∆∞·ª£t</td>
                            <td><?php echo $month['total_tickets']; ?> v√©</td>
                            <td><?php echo number_format($month['revenue']); ?> VNƒê</td>
                        </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Th·ªëng k√™ theo r·∫°p -->
        <div class="admin-card">
            <h3><i class="bi bi-building"></i> Th·ªëng K√™ Theo R·∫°p</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>T√™n R·∫°p</th>
                            <th>S·ªë l∆∞·ª£t ƒë·∫∑t</th>
                            <th>V√© ƒë√£ b√°n</th>
                            <th>Hi·ªáu su·∫•t</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($cinema_stats as $cinema): ?>
                        <tr>
                            <td><?php echo $cinema['name']; ?></td>
                            <td><?php echo $cinema['bookings'] ?: 0; ?> l∆∞·ª£t</td>
                            <td><?php echo $cinema['tickets_sold'] ?: 0; ?> v√©</td>
                            <td>
                                <?php 
                                $performance = $cinema['tickets_sold'] ?: 0;
                                if ($performance > 50) {
                                    echo '<span class="badge bg-success">Cao</span>';
                                } elseif ($performance > 20) {
                                    echo '<span class="badge bg-warning">Trung b√¨nh</span>';
                                } else {
                                    echo '<span class="badge bg-danger">Th·∫•p</span>';
                                }
                                ?>
                            </td>
                        </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="admin-card text-center">
            <a href="admin.php" class="btn btn-secondary me-2">
                <i class="bi bi-house"></i> V·ªÅ trang ch·ªß Admin
            </a>
            <a href="admin_tickets.php" class="btn btn-info me-2">
                <i class="bi bi-ticket-perforated"></i> Qu·∫£n l√Ω v√©
            </a>
            <a href="admin_users.php" class="btn btn-primary me-2">
                <i class="bi bi-people"></i> Qu·∫£n l√Ω kh√°ch h√†ng
            </a>
            <a href="logout.php" class="btn btn-danger">
                <i class="bi bi-power"></i> ƒêƒÉng xu·∫•t
            </a>
        </div>
    </div>
</body>

</html>
<?php
session_start();
require_once 'config.php';

// Ki·ªÉm tra quy·ªÅn admin
if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
    header("Location: login.html");
    exit;
}

// L·∫•y danh s√°ch t·∫•t c·∫£ v√© ƒë√£ ƒë·∫∑t
$stmt = $pdo->prepare("
    SELECT b.*, u.username, u.fullname, m.title as movie_title, 
           c.name as cinema_name, s.show_date, s.show_time,
           GROUP_CONCAT(bs.seat_number ORDER BY bs.seat_number) as seats
    FROM bookings b
    JOIN users u ON b.user_id = u.id
    JOIN showtimes s ON b.showtime_id = s.id
    JOIN movies m ON s.movie_id = m.id
    JOIN cinemas c ON s.cinema_id = c.id
    LEFT JOIN booked_seats bs ON b.id = bs.booking_id
    GROUP BY b.id
    ORDER BY b.booking_date DESC
");
$stmt->execute();
$bookings = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Th·ªëng k√™ t·ªïng quan
$stmt = $pdo->prepare("SELECT COUNT(*) as total_bookings FROM bookings");
$stmt->execute();
$total_bookings = $stmt->fetchColumn();

$stmt = $pdo->prepare("SELECT COUNT(*) as total_seats FROM booked_seats");
$stmt->execute();
$total_seats = $stmt->fetchColumn();

$stmt = $pdo->prepare("SELECT SUM(ticket_price * quantity) as total_revenue FROM bookings");
$stmt->execute();
$total_revenue = $stmt->fetchColumn() ?: 0;
?>

<!DOCTYPE html>
<html>

<head>
    <title>Qu·∫£n l√Ω V√© - Admin CGV</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            padding: 20px;
        }

        .admin-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .stats-card {
            background: linear-gradient(45deg, #4834d4, #686de0);
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .table th {
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="admin-card">
            <h1><i class="bi bi-ticket-perforated"></i> Qu·∫£n l√Ω V√© ƒê√£ ƒê·∫∑t</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="admin.php">Trang ch·ªß Admin</a></li>
                    <li class="breadcrumb-item active">Qu·∫£n l√Ω V√©</li>
                </ol>
            </nav>
        </div>

        <!-- Th·ªëng k√™ t·ªïng quan -->
        <div class="row">
            <div class="col-md-4">
                <div class="stats-card">
                    <h3><?php echo $total_bookings; ?></h3>
                    <p>T·ªïng s·ªë l∆∞·ª£t ƒë·∫∑t v√©</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stats-card">
                    <h3><?php echo $total_seats; ?></h3>
                    <p>T·ªïng s·ªë gh·∫ø ƒë√£ ƒë·∫∑t</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stats-card">
                    <h3><?php echo number_format($total_revenue); ?> VNƒê</h3>
                    <p>T·ªïng doanh thu</p>
                </div>
            </div>
        </div>

        <!-- Danh s√°ch v√© ƒë√£ ƒë·∫∑t -->
        <div class="admin-card">
            <h3>Danh s√°ch v√© ƒë√£ ƒë·∫∑t</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Kh√°ch h√†ng</th>
                            <th>Phim</th>
                            <th>R·∫°p</th>
                            <th>Ng√†y chi·∫øu</th>
                            <th>Gi·ªù chi·∫øu</th>
                            <th>Gh·∫ø ƒë√£ ƒë·∫∑t</th>
                            <th>S·ªë l∆∞·ª£ng</th>
                            <th>T·ªïng ti·ªÅn</th>
                            <th>Ng√†y ƒë·∫∑t</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($bookings as $booking): ?>
                        <tr>
                            <td><?php echo $booking['id']; ?></td>
                            <td>
                                <strong><?php echo $booking['fullname']; ?></strong><br>
                                <small>@<?php echo $booking['username']; ?></small>
                            </td>
                            <td><?php echo $booking['movie_title']; ?></td>
                            <td><?php echo $booking['cinema_name']; ?></td>
                            <td><?php echo date('d/m/Y', strtotime($booking['show_date'])); ?></td>
                            <td><?php echo date('H:i', strtotime($booking['show_time'])); ?></td>
                            <td>
                                <span class="badge bg-primary">
                                    <?php echo $booking['seats'] ?: 'N/A'; ?>
                                </span>
                            </td>
                            <td><?php echo $booking['quantity']; ?> v√©</td>
                            <td><?php echo number_format($booking['ticket_price'] * $booking['quantity']); ?> VNƒê</td>
                            <td><?php echo date('d/m/Y H:i', strtotime($booking['booking_date'])); ?></td>
                        </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="admin-card text-center">
            <a href="admin.php" class="btn btn-secondary me-2">
                <i class="bi bi-house"></i> V·ªÅ trang ch·ªß Admin
            </a>
            <a href="admin_stats.php" class="btn btn-info me-2">
                <i class="bi bi-graph-up"></i> Xem th·ªëng k√™ chi ti·∫øt
            </a>
            <a href="logout.php" class="btn btn-danger">
                <i class="bi bi-power"></i> ƒêƒÉng xu·∫•t
            </a>
        </div>
    </div>
</body>

</html>
<?php
session_start();
require_once 'config.php';

// Ki·ªÉm tra quy·ªÅn admin
if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
    header("Location: login.html");
    exit;
}

// L·∫•y danh s√°ch ng∆∞·ªùi d√πng
$stmt = $pdo->prepare("
    SELECT u.*, 
           COUNT(b.id) as total_bookings,
           SUM(b.quantity) as total_tickets,
           SUM(b.ticket_price * b.quantity) as total_spent
    FROM users u
    LEFT JOIN bookings b ON u.id = b.user_id
    WHERE u.role = 'customer'
    GROUP BY u.id
    ORDER BY u.registration_date DESC
");
$stmt->execute();
$users = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Th·ªëng k√™ ng∆∞·ªùi d√πng
$stmt = $pdo->prepare("SELECT COUNT(*) as total_users FROM users WHERE role = 'customer'");
$stmt->execute();
$total_users = $stmt->fetchColumn();

$stmt = $pdo->prepare("SELECT COUNT(*) as active_users FROM users WHERE role = 'customer' AND id IN (SELECT DISTINCT user_id FROM bookings)");
$stmt->execute();
$active_users = $stmt->fetchColumn();
?>

<!DOCTYPE html>
<html>

<head>
    <title>Qu·∫£n l√Ω Kh√°ch H√†ng - Admin CGV</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            padding: 20px;
        }

        .admin-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .stats-card {
            background: linear-gradient(45deg, #00d2d3, #01a3a4);
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .table th {
            background-color: #f8f9fa;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="admin-card">
            <h1><i class="bi bi-people"></i> Qu·∫£n l√Ω Kh√°ch H√†ng</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="admin.php">Trang ch·ªß Admin</a></li>
                    <li class="breadcrumb-item active">Qu·∫£n l√Ω Kh√°ch H√†ng</li>
                </ol>
            </nav>
        </div>

        <!-- Th·ªëng k√™ ng∆∞·ªùi d√πng -->
        <div class="row">
            <div class="col-md-6">
                <div class="stats-card">
                    <h3><?php echo $total_users; ?></h3>
                    <p>T·ªïng s·ªë kh√°ch h√†ng</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="stats-card">
                    <h3><?php echo $active_users; ?></h3>
                    <p>Kh√°ch h√†ng ƒë√£ ƒë·∫∑t v√©</p>
                </div>
            </div>
        </div>

        <!-- Danh s√°ch kh√°ch h√†ng -->
        <div class="admin-card">
            <h3>Danh s√°ch kh√°ch h√†ng</h3>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Avatar</th>
                            <th>Th√¥ng tin</th>
                            <th>Email</th>
                            <th>S·ªë ƒëi·ªán tho·∫°i</th>
                            <th>Ng√†y ƒëƒÉng k√Ω</th>
                            <th>Th·ªëng k√™ ƒë·∫∑t v√©</th>
                            <th>T·ªïng chi ti√™u</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($users as $user): ?>
                        <tr>
                            <td>
                                <div class="user-avatar">
                                    <?php echo strtoupper(substr($user['fullname'], 0, 1)); ?>
                                </div>
                            </td>
                            <td>
                                <strong><?php echo $user['fullname']; ?></strong><br>
                                <small class="text-muted">@<?php echo $user['username']; ?></small>
                            </td>
                            <td><?php echo $user['email']; ?></td>
                            <td><?php echo $user['phone'] ?: 'Ch∆∞a c·∫≠p nh·∫≠t'; ?></td>
                            <td><?php echo date('d/m/Y', strtotime($user['registration_date'])); ?></td>
                            <td>
                                <span class="badge bg-primary"><?php echo $user['total_bookings']; ?> l∆∞·ª£t</span><br>
                                <small><?php echo $user['total_tickets']; ?> v√©</small>
                            </td>
                            <td>
                                <strong><?php echo number_format($user['total_spent'] ?: 0); ?> VNƒê</strong>
                            </td>
                        </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="admin-card text-center">
            <a href="admin.php" class="btn btn-secondary me-2">
                <i class="bi bi-house"></i> V·ªÅ trang ch·ªß Admin
            </a>
            <a href="admin_tickets.php" class="btn btn-info me-2">
                <i class="bi bi-ticket-perforated"></i> Qu·∫£n l√Ω v√©
            </a>
            <a href="logout.php" class="btn btn-danger">
                <i class="bi bi-power"></i> ƒêƒÉng xu·∫•t
            </a>
        </div>
    </div>
</body>

</html>
<?php
$servername = "localhost:3308";
$username = "root";
$password = "";
$dbname = "cinema_booking";

try {
    $pdo = new PDO("mysql:host=$servername;dbname=$dbname;charset=utf8", $username, $password);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    die("K·∫øt n·ªëi database th·∫•t b·∫°i: " . $e->getMessage());
}
<?php
require_once 'config.php';

// T·∫°o t√†i kho·∫£n admin m·∫∑c ƒë·ªãnh
$admin_username = 'admin';
$admin_password = password_hash('admin123', PASSWORD_DEFAULT);
$admin_fullname = 'Administrator';
$admin_email = 'admin@cgv.com';

// Ki·ªÉm tra xem admin ƒë√£ t·ªìn t·∫°i ch∆∞a
$stmt = $pdo->prepare("SELECT id FROM users WHERE username = ? AND role = 'admin'");
$stmt->execute([$admin_username]);

if (!$stmt->fetch()) {
    // T·∫°o t√†i kho·∫£n admin
    $stmt = $pdo->prepare("INSERT INTO users (username, password, fullname, email, role, registration_date) VALUES (?, ?, ?, ?, 'admin', NOW())");
    
    if ($stmt->execute([$admin_username, $admin_password, $admin_fullname, $admin_email])) {
        echo "T·∫°o t√†i kho·∫£n admin th√†nh c√¥ng!<br>";
        echo "T√™n ƒëƒÉng nh·∫≠p: admin<br>";
        echo "M·∫≠t kh·∫©u: admin123<br>";
        echo "<a href='admin_login.html'>ƒêƒÉng nh·∫≠p Admin</a>";
    } else {
        echo "L·ªói t·∫°o t√†i kho·∫£n admin!";
    }
} else {
    echo "T√†i kho·∫£n admin ƒë√£ t·ªìn t·∫°i!<br>";
    echo "T√™n ƒëƒÉng nh·∫≠p: admin<br>";
    echo "M·∫≠t kh·∫©u: admin123<br>";
    echo "<a href='admin_login.html'>ƒêƒÉng nh·∫≠p Admin</a>";
}
?>
<?php
require_once 'config.php';

// L·∫•y movie_id t·ª´ URL (n·∫øu c√≥)
$selected_movie_id = isset($_GET['movie_id']) ? $_GET['movie_id'] : null;

// L·∫•y danh s√°ch phim t·ª´ database
$stmt = $pdo->prepare("SELECT id, title FROM movies ORDER BY title");
$stmt->execute();
$movies = $stmt->fetchAll(PDO::FETCH_ASSOC);

// L·∫•y danh s√°ch r·∫°p t·ª´ database  
$stmt = $pdo->prepare("SELECT id, name FROM cinemas ORDER BY name");
$stmt->execute();
$cinemas = $stmt->fetchAll(PDO::FETCH_ASSOC);

// L·∫•y th√¥ng tin phim ƒë∆∞·ª£c ch·ªçn (n·∫øu c√≥)
$selected_movie = null;
if ($selected_movie_id) {
    $stmt = $pdo->prepare("SELECT * FROM movies WHERE id = ?");
    $stmt->execute([$selected_movie_id]);
    $selected_movie = $stmt->fetch(PDO::FETCH_ASSOC);
}

// L·∫•y su·∫•t chi·∫øu c√≥ s·∫µn cho phim ƒë∆∞·ª£c ch·ªçn
$available_showtimes = [];
if ($selected_movie_id) {
    $stmt = $pdo->prepare("
        SELECT s.*, c.name as cinema_name 
        FROM showtimes s 
        JOIN cinemas c ON s.cinema_id = c.id 
        WHERE s.movie_id = ? AND s.show_date >= CURDATE() 
        ORDER BY s.show_date, s.show_time
    ");
    $stmt->execute([$selected_movie_id]);
    $available_showtimes = $stmt->fetchAll(PDO::FETCH_ASSOC);
}
?>
<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CGV - ƒê·∫∑t V√©</title>

    <!-- CSS li√™n k·∫øt -->
    <link rel="stylesheet" href="ASST1.css" />

    <!-- Icon c·ªßa trang -->
    <link rel="icon" href="./img/4.png" type="image/png" />

    <!-- Font Awesome ƒë·ªÉ d√πng icon dropdown -->
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>

<body>
    <div class="container">
        <!-- Thanh th√¥ng b√°o ch·∫°y -->
        <marquee behavior="scroll" direction="left">
            CGV Tr·∫ßn Duy H∆∞ng 1-6-2025 K·ªâ ni·ªám 22 nƒÉm th√†nh l·∫≠p - t·∫∑ng free b·∫Øp rang
            b∆° v√† n∆∞·ªõc khi mua t·ª´ 2 v√© tr·ªü l√™n
        </marquee>

        <!-- Ph·∫ßn ƒë·∫ßu -->
        <header></header>

        <!-- Menu ƒëi·ªÅu h∆∞·ªõng -->
        <nav>
            <ul>
                <li><a href="./index.php">Trang ch·ªß</a></li>
                <li class="dropdown">
                    <a href="#">Phim <i class="fas fa-chevron-down"></i></a>
                    <ul class="dropdown-content">
                        <li><a href="./movies.php?category=1">Phim H√†nh ƒê·ªông</a></li>
                        <li><a href="./movies.php?category=2">Phim T√¨nh C·∫£m</a></li>
                        <li><a href="./movies.php?category=3">Phim Ho·∫°t H√¨nh</a></li>
                    </ul>
                </li>
                <li><a href="./list_cgv.php">R·∫°p CGV</a></li>
                <li><a href="./list_user.html">Th√†nh vi√™n</a></li>
                <li><a href="./ap.html">Tuy·ªÉn d·ª•ng</a></li>
            </ul>
        </nav>

        <!-- Form ƒëƒÉng k√≠ mua v√© -->
        <div class="booking-container">
            <h3>ƒê·∫∑t V√© Xem Phim</h3>

            <?php if ($selected_movie): ?>
                <div class="selected-movie-info">
                    <h4>üé¨ Phim ƒë√£ ch·ªçn: <?php echo $selected_movie['title']; ?></h4>
                    <p><strong>Th·ªÉ lo·∫°i:</strong> <?php echo $selected_movie['genre']; ?></p>
                    <p><strong>Th·ªùi l∆∞·ª£ng:</strong> <?php echo $selected_movie['duration']; ?></p>
                </div>
            <?php endif; ?>

            <form action="datve_process.php" method="POST" id="bookingForm">
                <div>
                    <input
                        type="text"
                        name="customer_name"
                        placeholder="T√™n Kh√°ch h√†ng"
                        required />
                </div>
                <br />
                <div>
                    <input
                        type="text"
                        name="phone"
                        placeholder="S·ªë ƒêi·ªán Tho·∫°i"
                        required />
                </div>
                <br />

                <?php if ($selected_movie_id): ?>
                    <input type="hidden" name="movie_id" value="<?php echo $selected_movie_id; ?>" />
                <?php else: ?>
                    <div>
                        <select name="movie_id" required>
                            <option value="">Ch·ªçn phim</option>
                            <?php foreach ($movies as $movie): ?>
                                <option value="<?php echo $movie['id']; ?>"><?php echo $movie['title']; ?></option>
                            <?php endforeach; ?>
                        </select>
                    </div>
                    <br />
                <?php endif; ?>

                <!-- Ch·ªâ hi·ªÉn th·ªã su·∫•t chi·∫øu c√≥ s·∫µn -->
                <?php if (!empty($available_showtimes)): ?>
                    <div class="showtime-selection">
                        <h4>üìÖ Ch·ªçn su·∫•t chi·∫øu c√≥ s·∫µn:</h4>
                        <div class="showtime-grid">
                            <?php
                            $current_date = '';
                            foreach ($available_showtimes as $showtime):
                                if ($current_date != $showtime['show_date']):
                                    $current_date = $showtime['show_date'];
                                    echo "<h5>" . date('d/m/Y - l', strtotime($showtime['show_date'])) . "</h5>";
                                endif;
                            ?>
                                <label class="showtime-option">
                                    <input type="radio" name="showtime_id" value="<?php echo $showtime['id']; ?>" required />
                                    <span>
                                        <strong><?php echo $showtime['cinema_name']; ?></strong><br>
                                        ‚è∞ <?php echo date('H:i', strtotime($showtime['show_time'])); ?>
                                        (C√≤n <?php echo $showtime['available_seats']; ?>/<?php echo $showtime['total_seats']; ?> gh·∫ø)
                                    </span>
                                </label>
                            <?php endforeach; ?>
                        </div>
                    </div>
                <?php else: ?>
                    <div class="no-showtime">
                        <h4>üòî Hi·ªán t·∫°i ch∆∞a c√≥ su·∫•t chi·∫øu n√†o cho phim n√†y</h4>
                        <p>Vui l√≤ng ch·ªçn phim kh√°c ho·∫∑c quay l·∫°i sau.</p>
                        <button type="button" onclick="window.location.href='index.php'" class="btn-back">
                            üè† V·ªÅ trang ch·ªß
                        </button>
                    </div>
                <?php endif; ?>

                <input type="hidden" name="seats" id="selectedSeats" />

                <div class="screen">M√ÄN H√åNH</div>

                <div class="seats">
                    <!-- H√†ng A - Gh·∫ø th∆∞·ªùng -->
                    <div class="row" data-row="A">
                        <span class="row-label">A</span>
                        <div class="side">
                            <button type="button" class="seat">A1</button>
                            <button type="button" class="seat">A2</button>
                            <button type="button" class="seat">A3</button>
                            <button type="button" class="seat">A4</button>
                            <button type="button" class="seat">A5</button>
                            <button type="button" class="seat">A6</button>
                            <button type="button" class="seat">A7</button>
                        </div>
                        <div class="gap"></div>
                        <div class="side">
                            <button type="button" class="seat">A8</button>
                            <button type="button" class="seat">A9</button>
                            <button type="button" class="seat">A10</button>
                            <button type="button" class="seat">A11</button>
                            <button type="button" class="seat">A12</button>
                            <button type="button" class="seat">A13</button>
                            <button type="button" class="seat">A14</button>
                            <button type="button" class="seat">A15</button>
                        </div>
                    </div>

                    <!-- H√†ng B - Gh·∫ø VIP -->
                    <div class="row" data-row="B">
                        <span class="row-label">B</span>
                        <div class="side">
                            <button type="button" class="seat vip">B1</button>
                            <button type="button" class="seat vip">B2</button>
                            <button type="button" class="seat vip">B3</button>
                            <button type="button" class="seat vip">B4</button>
                            <button type="button" class="seat vip">B5</button>
                            <button type="button" class="seat vip">B6</button>
                            <button type="button" class="seat vip">B7</button>
                        </div>
                        <div class="gap"></div>
                        <div class="side">
                            <button type="button" class="seat vip">B8</button>
                            <button type="button" class="seat vip">B9</button>
                            <button type="button" class="seat vip">B10</button>
                            <button type="button" class="seat vip">B11</button>
                            <button type="button" class="seat vip">B12</button>
                            <button type="button" class="seat vip">B13</button>
                            <button type="button" class="seat vip">B14</button>
                            <button type="button" class="seat vip">B15</button>
                        </div>
                    </div>

                    <!-- H√†ng C - Gh·∫ø VIP -->
                    <div class="row" data-row="C">
                        <span class="row-label">C</span>
                        <div class="side">
                            <button type="button" class="seat vip">C1</button>
                            <button type="button" class="seat vip">C2</button>
                            <button type="button" class="seat vip">C3</button>
                            <button type="button" class="seat vip">C4</button>
                            <button type="button" class="seat vip">C5</button>
                            <button type="button" class="seat vip">C6</button>
                            <button type="button" class="seat vip">C7</button>
                        </div>
                        <div class="gap"></div>
                        <div class="side">
                            <button type="button" class="seat vip">C8</button>
                            <button type="button" class="seat vip">C9</button>
                            <button type="button" class="seat vip">C10</button>
                            <button type="button" class="seat vip">C11</button>
                            <button type="button" class="seat vip">C12</button>
                            <button type="button" class="seat vip">C13</button>
                            <button type="button" class="seat vip">C14</button>
                            <button type="button" class="seat vip">C15</button>
                        </div>
                    </div>

                    <!-- H√†ng D - Gh·∫ø Sweetbox -->
                    <div class="row" data-row="D">
                        <span class="row-label">D</span>
                        <div class="side">
                            <button type="button" class="seat sweetbox">D1</button>
                            <button type="button" class="seat sweetbox">D2</button>
                            <button type="button" class="seat sweetbox">D3</button>
                            <button type="button" class="seat sweetbox">D4</button>
                            <button type="button" class="seat sweetbox">D5</button>
                            <button type="button" class="seat sweetbox">D6</button>
                            <button type="button" class="seat sweetbox">D7</button>
                        </div>
                        <div class="gap"></div>
                        <div class="side">
                            <button type="button" class="seat sweetbox">D8</button>
                            <button type="button" class="seat sweetbox">D9</button>
                            <button type="button" class="seat sweetbox">D10</button>
                            <button type="button" class="seat sweetbox">D11</button>
                            <button type="button" class="seat sweetbox">D12</button>
                            <button type="button" class="seat sweetbox">D13</button>
                            <button type="button" class="seat sweetbox">D14</button>
                            <button type="button" class="seat sweetbox">D15</button>
                        </div>
                    </div>
                </div>

                <div class="legend">
                    <span><span class="seat"></span> Gh·∫ø th∆∞·ªùng (60,000ƒë)</span>
                    <span><span class="seat vip"></span> Gh·∫ø VIP (80,000ƒë)</span>
                    <span><span class="seat sweetbox"></span> Gh·∫ø Sweetbox (120,000ƒë)</span>
                    <span><span class="seat booked"></span> ƒê√£ ƒë·∫∑t</span>
                    <span><span class="seat selected"></span> ƒêang ch·ªçn</span>
                </div>

                <div class="exit">üö™ C·ª≠a ra/v√†o</div>
            </form>
        </div>

        <!-- Hi·ªÉn th·ªã gh·∫ø ƒë√£ ch·ªçn v√† t·ªïng ti·ªÅn -->
        <div class="booking-summary">
            <h4>Th√¥ng tin ƒë·∫∑t v√©:</h4>
            <p id="selectedSeatsDisplay">Gh·∫ø ƒë√£ ch·ªçn: Ch∆∞a ch·ªçn</p>
            <p id="totalPrice">T·ªïng ti·ªÅn: 0ƒë</p>
        </div>

        <!-- Kh·ªëi ch·ª©a n√∫t v√† th√¥ng b√°o -->
        <div class="center-wrapper">
            <button type="button" onclick="xacNhanDatVe()" class="confirm-button">
                X√°c nh·∫≠n ƒë·∫∑t v√©
            </button>
            <p id="thongbao" class="hidden success-message">
                B·∫°n ƒë√£ ƒë·∫∑t v√© th√†nh c√¥ng! H√£y ƒë·∫øn r·∫°p ƒë·ªÉ l·∫•y v√© v√† thanh to√°n.
            </p>
        </div>

        <!-- Footer -->
        <footer>
            <span>ChƒÉm s√≥c kh√°ch h√†ng</span>
        </footer>
    </div>

    <script>
        // Bi·∫øn l∆∞u gi√° v√© theo lo·∫°i gh·∫ø
        const seatPrices = {
            'seat': 60000, // Gh·∫ø th∆∞·ªùng
            'seat vip': 80000, // Gh·∫ø VIP  
            'seat sweetbox': 120000 // Gh·∫ø Sweetbox
        };

        // Gh·∫ø ƒë√£ ƒë·∫∑t t·ª´ database (s·∫Ω ƒë∆∞·ª£c load qua AJAX)
        let bookedSeats = [];

        // Load gh·∫ø ƒë√£ ƒë·∫∑t khi ch·ªçn su·∫•t chi·∫øu
        function loadBookedSeats(showtimeId) {
            if (!showtimeId) return;

            fetch(`get_booked_seats.php?showtime_id=${showtimeId}`)
                .then(response => response.json())
                .then(data => {
                    bookedSeats = data;
                    updateSeatDisplay();
                })
                .catch(error => console.error('Error:', error));
        }

        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã gh·∫ø
        function updateSeatDisplay() {
            // Reset t·∫•t c·∫£ gh·∫ø
            document.querySelectorAll('.seat').forEach(seat => {
                seat.classList.remove('booked');
            });

            // ƒê√°nh d·∫•u gh·∫ø ƒë√£ ƒë·∫∑t
            bookedSeats.forEach(seatNumber => {
                const seatElement = document.querySelector(`.seat:contains('${seatNumber}')`);
                if (seatElement) {
                    seatElement.classList.add('booked');
                }
            });

            // T√¨m element theo text content
            document.querySelectorAll('.seat').forEach(seat => {
                if (bookedSeats.includes(seat.textContent.trim())) {
                    seat.classList.add('booked');
                }
            });
        }

        // Ch·ªçn gh·∫ø
        const seats = document.querySelectorAll('.seat');
        seats.forEach((seat) => {
            seat.addEventListener('click', () => {
                if (!seat.classList.contains('booked')) {
                    seat.classList.toggle('selected');
                    updateBookingSummary();
                }
            });
        });

        // L·∫Øng nghe s·ª± ki·ªán ch·ªçn su·∫•t chi·∫øu
        document.addEventListener('change', function(e) {
            if (e.target.name === 'showtime_id') {
                loadBookedSeats(e.target.value);
            }
        });

        // C·∫≠p nh·∫≠t th√¥ng tin ƒë·∫∑t v√©
        function updateBookingSummary() {
            const selectedSeats = [];
            let totalPrice = 0;

            document.querySelectorAll('.seat.selected').forEach((seat) => {
                selectedSeats.push(seat.textContent);

                // T√≠nh gi√° d·ª±a tr√™n lo·∫°i gh·∫ø
                if (seat.classList.contains('sweetbox')) {
                    totalPrice += seatPrices['seat sweetbox'];
                } else if (seat.classList.contains('vip')) {
                    totalPrice += seatPrices['seat vip'];
                } else {
                    totalPrice += seatPrices['seat'];
                }
            });

            // C·∫≠p nh·∫≠t hi·ªÉn th·ªã
            document.getElementById('selectedSeatsDisplay').textContent =
                'Gh·∫ø ƒë√£ ch·ªçn: ' + (selectedSeats.length > 0 ? selectedSeats.join(', ') : 'Ch∆∞a ch·ªçn');
            document.getElementById('totalPrice').textContent =
                'T·ªïng ti·ªÅn: ' + totalPrice.toLocaleString('vi-VN') + 'ƒë';
        }

        function xacNhanDatVe() {
            // Thu th·∫≠p gh·∫ø ƒë√£ ch·ªçn
            const selectedSeats = [];
            document.querySelectorAll('.seat.selected').forEach((seat) => {
                selectedSeats.push(seat.textContent);
            });

            if (selectedSeats.length === 0) {
                alert('Vui l√≤ng ch·ªçn √≠t nh·∫•t 1 gh·∫ø!');
                return;
            }

            // Ki·ªÉm tra c√°c field b·∫Øt bu·ªôc
            const customerName = document.querySelector('input[name="customer_name"]').value;
            const phone = document.querySelector('input[name="phone"]').value;
            const movieId = document.querySelector('input[name="movie_id"], select[name="movie_id"]').value;

            if (!customerName || !phone || !movieId) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                return;
            }

            // Ki·ªÉm tra su·∫•t chi·∫øu ƒë√£ ƒë∆∞·ª£c ch·ªçn
            const showtimeId = document.querySelector('input[name="showtime_id"]:checked');
            if (!showtimeId) {
                alert('Vui l√≤ng ch·ªçn su·∫•t chi·∫øu!');
                return;
            }

            // C·∫≠p nh·∫≠t input hidden
            document.getElementById('selectedSeats').value = selectedSeats.join(',');

            // Submit form
            document.getElementById('bookingForm').submit();
        }

        // Load gh·∫ø ƒë√£ ƒë·∫∑t cho phim ƒë∆∞·ª£c ch·ªçn s·∫µn (n·∫øu c√≥)
        document.addEventListener('DOMContentLoaded', function() {
            const selectedShowtime = document.querySelector('input[name="showtime_id"]:checked');
            if (selectedShowtime) {
                loadBookedSeats(selectedShowtime.value);
            }
        });
    </script>
</body>

</html>
<?php
session_start();
require_once 'config.php';

if ($_POST) {
    $user_id = $_SESSION['user_id'] ?? null;
    $customer_name = $_POST['customer_name'];
    $phone = $_POST['phone'];
    $movie_id = $_POST['movie_id'];
    $seats = $_POST['seats'] ?? '';

    if (!$user_id) {
        echo "<script>alert('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ ƒë·∫∑t v√©!'); window.location.href='login.html';</script>";
        exit;
    }

    if (empty($seats)) {
        echo "<script>alert('Vui l√≤ng ch·ªçn gh·∫ø!'); window.location.href='datve.php?movie_id=$movie_id';</script>";
        exit;
    }

    try {
        $pdo->beginTransaction();

        // Kh√°ch h√†ng ch·ªâ ƒë∆∞·ª£c ch·ªçn t·ª´ su·∫•t chi·∫øu c√≥ s·∫µn
        if (!isset($_POST['showtime_id']) || empty($_POST['showtime_id'])) {
            throw new Exception("Vui l√≤ng ch·ªçn su·∫•t chi·∫øu!");
        }

        $showtime_id = $_POST['showtime_id'];

        // Ki·ªÉm tra su·∫•t chi·∫øu c√≥ t·ªìn t·∫°i v√† c√≤n gh·∫ø kh√¥ng
        $stmt = $pdo->prepare("SELECT * FROM showtimes WHERE id = ? AND available_seats > 0");
        $stmt->execute([$showtime_id]);
        $showtime = $stmt->fetch();

        if (!$showtime) {
            throw new Exception("Su·∫•t chi·∫øu kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ h·∫øt gh·∫ø!");
        }

        // Ki·ªÉm tra gh·∫ø ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t ch∆∞a
        $seatArray = explode(',', $seats);
        $seatArray = array_map('trim', $seatArray);

        if (count($seatArray) > $showtime['available_seats']) {
            throw new Exception("S·ªë gh·∫ø b·∫°n ch·ªçn v∆∞·ª£t qu√° s·ªë gh·∫ø c√≤n l·∫°i (" . $showtime['available_seats'] . " gh·∫ø)!");
        }

        foreach ($seatArray as $seat) {
            $stmt = $pdo->prepare("SELECT id FROM booked_seats WHERE showtime_id = ? AND seat_number = ?");
            $stmt->execute([$showtime_id, $seat]);
            if ($stmt->fetch()) {
                throw new Exception("Gh·∫ø $seat ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t!");
            }
        }        // T√≠nh gi√° v√© theo lo·∫°i gh·∫ø
        $total_price = 0;
        foreach ($seatArray as $seat) {
            $row = substr($seat, 0, 1); // L·∫•y h√†ng gh·∫ø (A, B, C, D)

            if ($row == 'A') {
                $total_price += 60000; // Gh·∫ø th∆∞·ªùng
            } elseif ($row == 'B' || $row == 'C') {
                $total_price += 80000; // Gh·∫ø VIP
            } elseif ($row == 'D') {
                $total_price += 120000; // Gh·∫ø Sweetbox
            }
        }

        // L∆∞u ƒë·∫∑t v√©
        $stmt = $pdo->prepare("INSERT INTO bookings (user_id, customer_name, phone, showtime_id, seats, total_price, status) VALUES (?, ?, ?, ?, ?, ?, 'confirmed')");
        $stmt->execute([$user_id, $customer_name, $phone, $showtime_id, $seats, $total_price]);
        $booking_id = $pdo->lastInsertId();

        // L∆∞u t·ª´ng gh·∫ø ƒë√£ ƒë·∫∑t
        foreach ($seatArray as $seat) {
            $stmt = $pdo->prepare("INSERT INTO booked_seats (showtime_id, seat_number, booking_id) VALUES (?, ?, ?)");
            $stmt->execute([$showtime_id, $seat, $booking_id]);
        }

        // C·∫≠p nh·∫≠t s·ªë gh·∫ø c√≤n l·∫°i
        $stmt = $pdo->prepare("UPDATE showtimes SET available_seats = available_seats - ? WHERE id = ?");
        $stmt->execute([count($seatArray), $showtime_id]);

        $pdo->commit();

        echo "<script>alert('ƒê·∫∑t v√© th√†nh c√¥ng! \\nT·ªïng ti·ªÅn: " . number_format($total_price) . "ƒë\\nKh√°ch h√†ng: $customer_name\\nSƒêT: $phone\\nGh·∫ø: $seats'); window.location.href='index.php';</script>";
    } catch (Exception $e) {
        $pdo->rollBack();
        echo "<script>alert('L·ªói: " . $e->getMessage() . "'); window.location.href='datve.php?movie_id=$movie_id';</script>";
    }
}
<?php
require_once 'config.php';

header('Content-Type: application/json');

$showtime_id = $_GET['showtime_id'] ?? null;

if (!$showtime_id) {
    echo json_encode([]);
    exit;
}

try {
    $stmt = $pdo->prepare("SELECT seat_number FROM booked_seats WHERE showtime_id = ?");
    $stmt->execute([$showtime_id]);
    $booked_seats = $stmt->fetchAll(PDO::FETCH_COLUMN);

    echo json_encode($booked_seats);
} catch (Exception $e) {
    echo json_encode([]);
}
<?php
require_once 'config.php';

$category_id = isset($_GET['category']) ? $_GET['category'] : null;

if ($category_id) {
    $stmt = $pdo->prepare("SELECT * FROM movies WHERE category_id = ? ORDER BY release_date DESC");
    $stmt->execute([$category_id]);
} else {
    $stmt = $pdo->prepare("SELECT * FROM movies ORDER BY release_date DESC");
    $stmt->execute();
}

$movies = $stmt->fetchAll(PDO::FETCH_ASSOC);

foreach ($movies as $movie) {
    echo '<div class="movie-card">';
    echo '<img src="' . $movie['image'] . '" alt="' . $movie['title'] . '" />';
    echo '<h3>' . $movie['title'] . '</h3>';
    echo '<p><strong>Th·ªÉ lo·∫°i:</strong> ' . $movie['genre'] . '</p>';
    echo '<p><strong>Th·ªùi l∆∞·ª£ng:</strong> ' . $movie['duration'] . '</p>';
    echo '<p><strong>Kh·ªüi chi·∫øu:</strong> ' . date('d-m-Y', strtotime($movie['release_date'])) . '</p>';
    echo '<button onclick="window.location.href=\'datve.php?movie_id=' . $movie['id'] . '\'">ƒê·∫∑t v√©</button>';
    echo '</div>';
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CGV-Trang ch·ªß</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="ASST1.css" />
    <link rel="icon" href="./img/4.png" />
</head>

<body>
    <div class="container">
        <marquee>CGV Tr·∫ßn Duy H∆∞ng 1-6-2025 K·ªâ ni·ªám 22 nƒÉm th√†nh l·∫≠p t·∫∑ng free b·∫Øp rang b∆° v√† n∆∞·ªõc khi mua t·ª´ 2 v√© tr·ªü
            l√™n</marquee>
        <header></header>
        <nav>
            <ul>
                <li><a href="./index.php">Trang ch·ªß</a></li>
                <li class="dropdown">
                    <a href="#"> phim <i class="fas fa-chevron-down"></i> </a>
                    <ul class="dropdown-content">
                        <li><a href="./movies.php?category=1">Phim H√†nh ƒê·ªông</a></li>
                        <li><a href="./movies.php?category=2">Phim T√¨nh C·∫£m</a></li>
                        <li><a href="./movies.php?category=3">Phim Ho·∫°t H√¨nh</a></li>
                    </ul>
                </li>
                <li><a href="./list_cgv.php">rap cgv</a></li>
                <li><a href="./list_user.html">th√†nh vi√™n</a></li>
                <li><a href="./ap.html">tuy·ªÉn d·ª•ng</a></li>
            </ul>
        </nav>

        <aside>
            <span>
                <h4>ƒëƒÉng k√≠ mua v√©</h4>
                <div><input type="text" placeholder="ƒëi·ªÅn th√¥ng tinn v√†o ƒë√¢y" /></div>
                <button onclick="window.location.href='datve.php'">ƒë·∫∑t v√©</button>
            </span>
            <span>
                <h3 id="t1">Gi·ªõi thi·ªáu CGV</h3>
                <p>
                    CJ CGV l√† m·ªôt trong top 5 c·ª•m r·∫°p chi·∫øu phim l·ªõn nh·∫•t to√†n c·∫ßu v√† l√†
                    nh√† ph√°t h√†nh, c·ª•m r·∫°p chi·∫øu phim l·ªõn nh·∫•t Vi·ªát Nam.M·ª•c ti√™u c·ªßa
                    ch√∫ng t√¥i l√† tr·ªü th√†nh h√¨nh m·∫´u c√¥ng ty ƒëi·ªÉn h√¨nh ƒë√≥ng g√≥p cho s·ª±
                    ph√°t tri·ªÉn kh√¥ng ng·ª´ng c·ªßa ng√†nh c√¥ng nghi·ªáp ƒëi·ªán img Vi·ªát Nam.
                </p>
                <p>
                    CJ CGV ƒë√£ t·∫°o n√™n kh√°i ni·ªám ƒë·ªôc ƒë√°o v·ªÅ vi·ªác chuy·ªÉn ƒë·ªïi r·∫°p chi·∫øu
                    phim truy·ªÅn th·ªëng th√†nh t·ªï h·ª£p vƒÉn h√≥a ‚ÄúCultureplex‚Äù, n∆°i kh√°n gi·∫£
                    kh√¥ng ch·ªâ ƒë·∫øn th∆∞·ªüng th·ª©c ƒëi·ªán img ƒëa d·∫°ng th√¥ng qua c√°c c√¥ng ngh·ªá
                    ti√™n ti·∫øn nh∆∞ SCREENX, IMAX, STARIUM, 4DX, Dolby Atmos, c≈©ng nh∆∞
                    th∆∞·ªüng th·ª©c ·∫©m th·ª±c ho√†n to√†n m·ªõi v√† kh√°c bi·ªát trong khi tr·∫£i nghi·ªám
                    d·ªãch v·ª• ch·∫•t l∆∞·ª£ng nh·∫•t t·∫°i CGV.
                </p>
                <p>
                    Th√¥ng qua nh·ªØng n·ªó l·ª±c trong vi·ªác x√¢y d·ª±ng ch∆∞∆°ng tr√¨nh Nh√† bi√™n
                    k·ªãch t√†i nƒÉng, D·ª± √°n phim ng·∫Øn CJ, L·ªõp h·ªçc l√†m phim TOTO, CGV
                    ArtHouse c√πng vi·ªác t√†i tr·ª£ cho c√°c ho·∫°t ƒë·ªông li√™n hoan phim l·ªõn
                    trong n∆∞·ªõc nh∆∞ Li√™n hoan Phim qu·ªëc t·∫ø H√† N·ªôi, Li√™n hoan Phim Vi·ªát
                    Nam, CJ CGV Vi·ªát Nam mong mu·ªën s·∫Ω kh√°m ph√° v√† h·ªó tr·ª£ ph√°t tri·ªÉn cho
                    c√°c nh√† l√†m phim tr·∫ª t√†i nƒÉng c·ªßa Vi·ªát Nam.
                </p>
            </span>
        </aside>

        <article>
            <div class="main-content">
                <div class="movie-section">
                    <h1>PHIM ƒêANG CHI·∫æU</h1>
                    <div class="movie-grid">
                        <?php include 'get_movies.php'; ?>
                    </div>
                </div>
            </div>
        </article>

        <footer>
            <span>chƒÉm s√≥c kh√°ch h√†ng</span>
        </footer>
    </div>
</body>

</html>
<?php
require_once 'config.php';

// L·∫•y danh s√°ch r·∫°p t·ª´ database
$stmt = $pdo->prepare("SELECT * FROM cinemas ORDER BY name");
$stmt->execute();
$cinemas = $stmt->fetchAll(PDO::FETCH_ASSOC);
?>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CGV</title>
    <link rel="stylesheet" href="ASST1.css" />
    <link rel="icon" href="./img/4.png" />
</head>

<body>
    <div class="container">
        <marquee>CGV Tr·∫ßn Duy H∆∞ng 1-6-2025 K·ªâ ni·ªám 22 nƒÉm th√†nh l·∫≠p t·∫∑ng free b·∫Øp rang b∆° v√† n∆∞·ªõc khi mua t·ª´ 2 v√© tr·ªü l√™n</marquee>
        <header></header>
        <nav>
            <ul>
                <li><a href="./index.php">trang ch·ªß</a></li>
                <li class="dropdown">
                    <a href="#"> phim <i class="fas fa-chevron-down"></i> </a>
                    <ul class="dropdown-content">
                        <li><a href="./movies.php?category=1">Phim H√†nh ƒê·ªông</a></li>
                        <li><a href="./movies.php?category=2">Phim T√¨nh C·∫£m</a></li>
                        <li><a href="./movies.php?category=3">Phim Ho·∫°t H√¨nh</a></li>
                    </ul>
                </li>
                <li><a href="./list_cgv.php">rap cgv</a></li>
                <li><a href="./list_user.html">th√†nh vi√™n</a></li>
                <li><a href="./ap.html">tuy·ªÉn d·ª•ng</a></li>
            </ul>
        </nav>

        <article>
            <div class="container">
                <h1>DANH S√ÅCH R·∫†P CGV</h1>
                <div class="cinema-grid">
                    <?php foreach ($cinemas as $cinema): ?>
                        <div class="cinema-card">
                            <img src="<?php echo $cinema['image']; ?>" alt="<?php echo $cinema['name']; ?>" style="width: 200px; height: 150px; object-fit: cover;" />
                            <h3><?php echo $cinema['name']; ?></h3>
                            <p><?php echo $cinema['address']; ?></p>
                        </div>
                    <?php endforeach; ?>
                </div>
            </div>
        </article>
        <footer>
            <span>chƒÉm s√≥c kh√°ch h√†ng</span>
        </footer>
    </div>
</body>

</html>
<?php
session_start();
require_once 'config.php';

if ($_POST) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    $stmt = $pdo->prepare("SELECT id, username, email, password, role FROM users WHERE username = ?");
    $stmt->execute([$username]);
    $user = $stmt->fetch();

    if ($user && password_verify($password, $user['password'])) {
        $_SESSION['user_id'] = $user['id'];
        $_SESSION['username'] = $user['username'];
        $_SESSION['role'] = $user['role'];

        if ($user['role'] == 'admin') {
            header("Location: admin.php");
        } else {
            header("Location: ASST1.html");
        }
    } else {
        echo "<script>alert('T√™n ƒëƒÉng nh·∫≠p ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!'); window.location.href='login.html';</script>";
    }
}
<?php
session_start();
session_destroy();
header("Location: ASST1.html");
exit;
<?php
require_once 'config.php';

$category_id = $_GET['category'] ?? 1;
$category_names = [1 => 'H√ÄNH ƒê·ªòNG', 2 => 'T√åNH C·∫¢M', 3 => 'HO·∫†T H√åNH'];
$category_name = $category_names[$category_id] ?? 'PHIM';

$stmt = $pdo->prepare("SELECT * FROM movies WHERE category_id = ?");
$stmt->execute([$category_id]);
$movies = $stmt->fetchAll(PDO::FETCH_ASSOC);
?>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>CGV-Phim <?php echo $category_name; ?></title>
    <link rel="stylesheet" href="ASST1.css" />
    <link rel="icon" href="./img/4.png" />
</head>

<body>
    <div class="container">
        <marquee>CGV Tr·∫ßn Duy H∆∞ng 1-6-2025 K·ªâ ni·ªám 22 nƒÉm th√†nh l·∫≠p t·∫∑ng free b·∫Øp rang b∆° v√† n∆∞·ªõc khi mua t·ª´ 2 v√© tr·ªü
            l√™n</marquee>
        <header></header>
        <nav>
            <ul>
                <li><a href="./index.php">trang ch·ªß</a></li>
                <li class="dropdown">
                    <a href="#"> phim <i class="fas fa-chevron-down"></i> </a>
                    <ul class="dropdown-content">
                        <li><a href="./movies.php?category=1">Phim H√†nh ƒê·ªông</a></li>
                        <li><a href="./movies.php?category=2">Phim T√¨nh C·∫£m</a></li>
                        <li><a href="./movies.php?category=3">Phim Ho·∫°t H√¨nh</a></li>
                    </ul>
                </li>
                <li><a href="./list_cgv.html">rap cgv</a></li>
                <li><a href="./list_user.html">th√†nh vi√™n</a></li>
                <li><a href="./ap.html">tuy·ªÉn d·ª•ng</a></li>
            </ul>
        </nav>

        <aside>
            <!-- ...existing code... -->
        </aside>

        <article>
            <div class="main-content">
                <div class="movie-section">
                    <h1>PHIM <?php echo $category_name; ?></h1>
                    <div class="movie-grid">
                        <?php foreach ($movies as $movie): ?>
                        <div class="movie-card">
                            <img src="<?php echo $movie['image']; ?>" alt="<?php echo $movie['title']; ?>" />
                            <h3><?php echo $movie['title']; ?></h3>
                            <p><strong>Th·ªÉ lo·∫°i:</strong> <?php echo $movie['genre']; ?></p>
                            <p><strong>Th·ªùi l∆∞·ª£ng:</strong> <?php echo $movie['duration']; ?></p>
                            <p><strong>Kh·ªüi chi·∫øu:</strong>
                                <?php echo date('d-m-Y', strtotime($movie['release_date'])); ?></p>
                            <button onclick="window.location.href='datve.php?movie_id=<?php echo $movie['id']; ?>'">ƒê·∫∑t
                                v√©</button>
                        </div>
                        <?php endforeach; ?>
                    </div>
                </div>
            </div>
        </article>

        <footer>
            <span>chƒÉm s√≥c kh√°ch h√†ng</span>
        </footer>
    </div>
</body>

</html>
<?php
require_once 'config.php';

if ($_POST) {
    $username = $_POST['username'];
    $email = $_POST['email'];
    $password = $_POST['password'];
    $confirm_password = $_POST['confirm_password'];

    // Ki·ªÉm tra m·∫≠t kh·∫©u
    if ($password !== $confirm_password) {
        echo "<script>alert('M·∫≠t kh·∫©u kh√¥ng kh·ªõp!'); window.location.href='register.html';</script>";
        exit;
    }

    // Ki·ªÉm tra username ƒë√£ t·ªìn t·∫°i
    $stmt = $pdo->prepare("SELECT id FROM users WHERE username = ? OR email = ?");
    $stmt->execute([$username, $email]);

    if ($stmt->rowCount() > 0) {
        echo "<script>alert('T√™n ƒëƒÉng nh·∫≠p ho·∫∑c email ƒë√£ t·ªìn t·∫°i!'); window.location.href='register.html';</script>";
        exit;
    }

    // Th√™m user m·ªõi
    $hashed_password = password_hash($password, PASSWORD_DEFAULT);
    $stmt = $pdo->prepare("INSERT INTO users (username, email, password, role) VALUES (?, ?, ?, 'customer')");

    if ($stmt->execute([$username, $email, $hashed_password])) {
        echo "<script>alert('ƒêƒÉng k√Ω th√†nh c√¥ng!'); window.location.href='login.html';</script>";
    } else {
        echo "<script>alert('ƒêƒÉng k√Ω th·∫•t b·∫°i!'); window.location.href='register.html';</script>";
    }
}
